# 食事する哲学者

哲学者が食事をします．

![哲学者達](https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/An_illustration_of_the_dining_philosophers_problem.png/231px-An_illustration_of_the_dining_philosophers_problem.png)

図は5人の哲学者と5つのフォークがあることを表しています．
- 哲学者は左右にあるフォーク2本を使ってスパゲッティを食べます．
- 哲学者はフォークを1本ずつしか持ち上げることができません．
- 哲学者同士で会話を行わないためフォークのデッドロックが発生するかもしれません．

並行性プロセスの問題です．

# モニタ

- 哲学者は両隣の哲学者が食事していない時だけ食事できます．
  - 1本目のフォークを取ったものの2本目のフォークが取れなかった時は1本目のフォークを置いて，1本目から改めてフォークを取ります．
- 両隣の哲学者が食事しているかチェックが必要になります．
  - 加えて左の哲学者が食事していないのを確認し，右の哲学者が食事しているか確認しようとした際に左の哲学者が食事を開始している場合もあります．
  - そこで**モニタ**という手法によって哲学者同士で相互単一ロックの共有を行います．
- モニタの役割は様々です．
  - 両隣の哲学者をチェック(`test`)，フォークを取る(`pick up`)，フォークを置く(`put down`)という3つのプロセスを行います．
  - 食事したい哲学者がいると，1本目のフォークを手放すようにし，2本目が入手可能の時点で1本目のフォークから再試行を行います．
  - 食事を終えた哲学者はモニタにシグナルを送信し，フォークが使用可能であることを伝えます．

# 実行方法

Processing(Java)であれば動きます．

pdeファイルをProcessingで開いて実行すると，コンソールに食事の様子が出力されます．
永遠に続くようにしているので，適宜停止ボタンで処理を停止してください．
